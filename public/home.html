<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Resort Booking â€“ Trang chá»§</title>
  <link rel="stylesheet" href="home.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <header class="navbar">
    <div class="navbar-container">
      <div class="navbar-logo">
        <h1>Resort Booking</h1>
      </div>
      <nav class="navbar-menu">
        <a href="">Khuyáº¿n mÃ£i</a>
        <a href="supports/support.html">Há»— trá»£</a>
        <a href="">Há»£p tÃ¡c vá»›i chÃºng tÃ´i</a>
        <a href="">Äáº·t chá»— cá»§a tÃ´i</a>
        <a href="login.html" class="btn-login">ÄÄƒng nháº­p</a>
        <a href="register.html" class="btn-register">ÄÄƒng kÃ½</a>
      </nav>
    </div>
    <nav class="navbar-menu">
      <a href="">Khuyáº¿n mÃ£i</a>
      <a href="">Há»— trá»£</a>
      <a href="">Há»£p tÃ¡c vá»›i chÃºng tÃ´i</a>
      <a href="">Äáº·t chá»— cá»§a tÃ´i</a>
      <a href="login.html" class="btn-login">ÄÄƒng nháº­p</a>
      <a href="register.html" class="btn-register">ÄÄƒng kÃ½</a>
    </nav>
  </div>
</header>

  <div class="search-container">
    <div class="search-header">
      <h2>TÃ¬m resort hoÃ n háº£o cho ká»³ nghá»‰ cá»§a báº¡n</h2>
      <p>Táº­n hÆ°á»Ÿng nhá»¯ng Æ°u Ä‘Ã£i tá»‘t nháº¥t cho ká»³ nghá»‰ trong mÆ¡ cá»§a báº¡n</p>
    </div>
    <div class="resort_type">
      <button class="type-btn active" data-type="resort">KhÃ¡ch sáº¡n</button>
      <button class="type-btn" data-type="villa">Biá»‡t thá»±</button>
      <button class="type-btn" data-type="apartment">CÄƒn há»™</button>
    </div>
    <div class="search-instructions"></div>
    <section class="search-form">
      <label>
        Äá»‹a Ä‘iá»ƒm
        <input type="text" id="location" placeholder="Nháº­p thÃ nh phá»‘ hoáº·c resort" />
      </label>
      <label>
        NgÃ y nháº­n & tráº£
        <input type="text" id="dateRange" placeholder="Chá»n khoáº£ng ngÃ y" readonly />
      </label>
      <label>
        KhÃ¡ch
        <select id="guests">
          <option value="1">1 khÃ¡ch</option>
          <option value="2" selected>2 khÃ¡ch</option>
          <option value="3">3 khÃ¡ch</option>
          <option value="4">4 khÃ¡ch</option>
        </select>
      </label>
      <button id="searchBtn">TÃ¬m kiáº¿m</button>
    </section>
  </div>

  <section class="resorts" id="resortList">
    <!-- Danh sÃ¡ch resort sáº½ render á»Ÿ Ä‘Ã¢y -->
  </section>

  <section class="promo-codes">
    <h2><span class="icon">ğŸ</span> MÃ£ Æ¯u ÄÃ£i Táº·ng Báº¡n Má»›i</h2>
    <button class="promo-arrow left" id="prevBtn"><i>&#10094;</i></button>
    <div class="promo-grid" id="promoGrid"></div>
    <button class="promo-arrow right" id="nextBtn"><i>&#10095;</i></button>
  </section>

  <!-- Æ¯U ÄÃƒI Ná»”I Báº¬T - Pháº§n Ä‘Æ°á»£c sá»­a -->
  <section class="deals-section">
    <h2>Æ¯u Ä‘Ã£i ná»•i báº­t</h2>
    <div class="resort-grid" id="dealsGrid">
      <!-- Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c render tá»« API -->
    </div>
  </section>

  <!-- ÄIá»‚M Äáº¾N PHá»” BIáº¾N -->
  <section class="popular-destinations">
    <h2>Äiá»ƒm Ä‘áº¿n phá»• biáº¿n</h2>
    <div class="destination-grid" id="destinationGrid"></div>
  </section>

  <!-- VÃŒ SAO NÃŠN CHá»ŒN CHÃšNG TÃ”I -->
  <section class="why-choose-us">
    <h2>VÃ¬ sao nÃªn chá»n Resort Booking?</h2>
    <div class="reasons">
      <div class="reason">
        <img src="Assets/Icon Images/thumbs-up.png" alt="Äáº·t phÃ²ng dá»… dÃ ng">
        <h4>Äáº·t chá»— dá»… dÃ ng</h4>
        <p>Chá»‰ vÃ i bÆ°á»›c Ä‘Æ¡n giáº£n Ä‘á»ƒ hoÃ n táº¥t Ä‘áº·t phÃ²ng cá»§a báº¡n.</p>
      </div>
      <div class="reason">
        <img src="Assets/Icon Images/voucher.png" alt="Æ¯u Ä‘Ã£i háº¥p dáº«n">
        <h4>Æ¯u Ä‘Ã£i háº¥p dáº«n</h4>
        <p>GiÃ¡ tá»‘t nháº¥t má»—i ngÃ y dÃ nh cho khÃ¡ch hÃ ng thÃ¢n thiáº¿t.</p>
      </div>
      <div class="reason">
        <img src="Assets/Icon Images/customer-service.png" alt="Há»— trá»£ 24/7">
        <h4>Há»— trá»£ 24/7</h4>
        <p>Äá»™i ngÅ© CSKH sáºµn sÃ ng há»— trá»£ báº¡n má»i lÃºc, má»i nÆ¡i.</p>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="footer-container">
      <div class="footer-links">
        <a href="#">ChÃ­nh sÃ¡ch báº£o máº­t</a>
        <span>|</span>
        <a href="#">Äiá»u khoáº£n sá»­ dá»¥ng</a>
        <span>|</span>
        <a href="#">LiÃªn há»‡</a>
      </div>

      <div class="footer-social">
        <p>Theo dÃµi chÃºng tÃ´i</p>
        <div class="social-icons">
          <a href="#"><img src="Assets/Icon Images/facebook.png" alt="Facebook"></a>
          <a href="#"><img src="Assets/Icon Images/instagram.png" alt="Instagram"></a>
          <a href="#"><img src="Assets/Icon Images/communication.png" alt="Telegram"></a>
          <a href="#"><img src="https://cdn-icons-png.flaticon.com/512/3046/3046126.png" alt="TikTok"></a>
        </div>
      </div>
      <br/>
      <p>Â© 2025 <span>Resort Booking</span>. All rights reserved.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/vn.js"></script>
  <script src="voucher.js"></script>
  <script src="destinations.js"></script>

  <!-- Script xá»­ lÃ½ hiá»ƒn thá»‹ phÃ²ng -->
 <script>
    // Fetch dá»¯ liá»‡u phÃ²ng tá»« API
    async function fetchRooms() {
      try {
        // Äáº£m báº£o URL nÃ y lÃ  chÃ­nh xÃ¡c
        const response = await fetch('http://localhost:5500/api/rooms'); 
        const rooms = await response.json();
        return rooms;
      } catch (error) {
        console.error('Lá»—i khi láº¥y dá»¯ liá»‡u phÃ²ng:', error);
        return [];
      }
    }

    // HÃ m render phÃ²ng vÃ o má»™t container (grid) cá»¥ thá»ƒ
    function renderRooms(rooms, containerId) {
      const container = document.getElementById(containerId);
      if (!container) {
        console.error(`KhÃ´ng tÃ¬m tháº¥y container vá»›i ID: ${containerId}`);
        return;
      }
      container.innerHTML = ''; // XÃ³a ná»™i dung cÅ©

      // ThÃªm class 'resort-grid' vÃ o #resortList Ä‘á»ƒ Ã¡p dá»¥ng CSS tÆ°Æ¡ng tá»±
      if (containerId === 'resortList') {
        container.classList.add('resort-grid');
      }

      rooms.forEach(room => {
        const card = document.createElement('div');
        card.className = 'resort-card';
        
        // Format giÃ¡ tiá»n VND
        const formattedPrice = new Intl.NumberFormat('vi-VN', {
          style: 'currency',
          currency: 'VND'
        }).format(room.price_per_night);

        card.innerHTML = `
          <img src="${room.images?.[0] || 'Assets/placeholder.jpg'}" alt="${room.room_type}">
          <div class="resort-info">
            <h3>${room.room_type}</h3>
            <p><i class="fas fa-map-marker-alt"></i> ${room.location || 'HÃ  Ná»™i'}</p>
            <p class="price">Tá»« <span>${formattedPrice}/Ä‘Ãªm</span></p>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Load vÃ  render dá»¯ liá»‡u khi trang Ä‘Æ°á»£c load
    document.addEventListener('DOMContentLoaded', async () => {
      const rooms = await fetchRooms();
      
      // 1. Render vÃ o pháº§n Æ¯U ÄÃƒI Ná»”I Báº¬T
      renderRooms(rooms, 'dealsGrid'); 

      // 2. Render vÃ o pháº§n DANH SÃCH RESORT (ngay dÆ°á»›i thanh tÃ¬m kiáº¿m)
      renderRooms(rooms, 'resortList');
    });

    // Xá»­ lÃ½ nÃºt chá»n loáº¡i phÃ²ng
    const typeButtons = document.querySelectorAll('.type-btn');
    typeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        typeButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const selectedType = btn.dataset.type;
        console.log('Loáº¡i chá»— á»Ÿ Ä‘Æ°á»£c chá»n:', selectedType);
        // ThÃªm logic lá»c resort theo loáº¡i á»Ÿ Ä‘Ã¢y náº¿u cáº§n
      });
    });

    // Xá»­ lÃ½ nÃºt prev/next cá»§a promo
    const grid = document.getElementById('promoGrid');
    document.getElementById('nextBtn').onclick = () => grid.scrollBy({ left: 360, behavior: 'smooth' });
    document.getElementById('prevBtn').onclick = () => grid.scrollBy({ left: -360, behavior: 'smooth' });

    // Xá»­ lÃ½ destinations
    const destinationGrid = document.getElementById('destinationGrid');
    // Giáº£ Ä‘á»‹nh máº£ng `destinations` Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong destinations.js
    if (typeof destinations !== 'undefined') {
      destinations.forEach(place => {
        const card = document.createElement('div');
        card.className = 'destination-card';
        card.innerHTML = `
          <img src="${place.image}" alt="${place.name}">
          <p>${place.name}</p>
        `;
        destinationGrid.appendChild(card);
      });
    } else {
      console.warn('KhÃ´ng tÃ¬m tháº¥y máº£ng "destinations". Äáº£m báº£o destinations.js Ä‘Ã£ Ä‘Æ°á»£c táº£i.');
    }
  </script>
</body>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const navbarMenu = document.querySelector(".navbar-menu");

  // Láº¥y thÃ´ng tin tá»« localStorage
  const username = localStorage.getItem("username");
  const full_name = localStorage.getItem("full_name");

  // Náº¿u ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p
  if (username || full_name) {
    navbarMenu.innerHTML = `
      <a href="">Khuyáº¿n mÃ£i</a>
      <a href="supports/support.html">Há»— trá»£</a>
      <a href="">Há»£p tÃ¡c vá»›i chÃºng tÃ´i</a>
      <a href="">Äáº·t chá»— cá»§a tÃ´i</a>
      <div class="user-menu">
        <span class="user-name">ğŸ‘¤ ${full_name || username}</span>
        <button id="logoutBtn" class="btn-logout">ÄÄƒng xuáº¥t</button>
      </div>
    `;

    // Khi báº¥m Ä‘Äƒng xuáº¥t
    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("token");
      localStorage.removeItem("username");
      localStorage.removeItem("full_name");
      localStorage.removeItem("role");
      window.location.href = "login.html";
    });
  }
});
</script>

</html>

