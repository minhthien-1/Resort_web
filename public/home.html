<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Resort Booking ‚Äì Trang ch·ªß</title>
  <link rel="stylesheet" href="home.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <header class="navbar">
    <div class="navbar-container">
      <div class="navbar-logo">
        <h1>Resort Booking</h1>
      </div>
      <nav class="navbar-menu">
        <a href="">Khuy·∫øn m√£i</a>
        <a href="supports/support.html">H·ªó tr·ª£</a>
        <a href="">H·ª£p t√°c v·ªõi ch√∫ng t√¥i</a>
        <a href="">ƒê·∫∑t ch·ªó c·ªßa t√¥i</a>
        <a href="login.html" class="btn-login">ƒêƒÉng nh·∫≠p</a>
        <a href="register.html" class="btn-register">ƒêƒÉng k√Ω</a>
      </nav>
    </div>
  </header>

  <div class="search-container">
    <div class="search-header">
      <h2>T√¨m resort ho√†n h·∫£o cho k·ª≥ ngh·ªâ c·ªßa b·∫°n</h2>
      <p>T·∫≠n h∆∞·ªüng nh·ªØng ∆∞u ƒë√£i t·ªët nh·∫•t cho k·ª≥ ngh·ªâ trong m∆° c·ªßa b·∫°n</p>
    </div>
    <div class="resort_type">
      <button class="type-btn active" data-type="resort">Kh√°ch s·∫°n</button>
      <button class="type-btn" data-type="villa">Bi·ªát th·ª±</button>
      <button class="type-btn" data-type="apartment">CƒÉn h·ªô</button>
    </div>
    <div class="search-instructions"></div>
    <section class="search-form">
      <label>
        ƒê·ªãa ƒëi·ªÉm
        <input type="text" id="location" placeholder="Nh·∫≠p th√†nh ph·ªë ho·∫∑c resort" />
      </label>
      <label>
        Ng√†y nh·∫≠n & tr·∫£
        <input type="text" id="dateRange" placeholder="Ch·ªçn kho·∫£ng ng√†y" readonly />
      </label>
      <label>
        Kh√°ch
        <select id="guests">
          <option value="1">1 kh√°ch</option>
          <option value="2" selected>2 kh√°ch</option>
          <option value="3">3 kh√°ch</option>
          <option value="4">4 kh√°ch</option>
        </select>
      </label>
      <button id="searchBtn">T√¨m ki·∫øm</button>
    </section>
  </div>

  <section class="resorts" id="resortList">
    <!-- Danh s√°ch resort s·∫Ω render ·ªü ƒë√¢y -->
  </section>

  <section class="promo-codes">
    <h2><span class="icon">üéÅ</span> M√£ ∆Øu ƒê√£i T·∫∑ng B·∫°n M·ªõi</h2>
    <button class="promo-arrow left" id="prevBtn"><i>&#10094;</i></button>
    <div class="promo-grid" id="promoGrid"></div>
    <button class="promo-arrow right" id="nextBtn"><i>&#10095;</i></button>
  </section>

  <!-- ∆ØU ƒê√ÉI N·ªîI B·∫¨T - Ph·∫ßn ƒë∆∞·ª£c s·ª≠a -->
  <section class="deals-section">
    <h2>∆Øu ƒë√£i n·ªïi b·∫≠t</h2>
    <div class="resort-grid" id="dealsGrid">
      <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c render t·ª´ API -->
    </div>
  </section>

  <!-- ƒêI·ªÇM ƒê·∫æN PH·ªî BI·∫æN -->
  <section class="popular-destinations">
    <h2>ƒêi·ªÉm ƒë·∫øn ph·ªï bi·∫øn</h2>
    <div class="destination-grid" id="destinationGrid"></div>
  </section>

  <!-- V√å SAO N√äN CH·ªåN CH√öNG T√îI -->
  <section class="why-choose-us">
    <h2>V√¨ sao n√™n ch·ªçn Resort Booking?</h2>
    <div class="reasons">
      <div class="reason">
        <img src="Assets/Icon Images/thumbs-up.png" alt="ƒê·∫∑t ph√≤ng d·ªÖ d√†ng">
        <h4>ƒê·∫∑t ch·ªó d·ªÖ d√†ng</h4>
        <p>Ch·ªâ v√†i b∆∞·ªõc ƒë∆°n gi·∫£n ƒë·ªÉ ho√†n t·∫•t ƒë·∫∑t ph√≤ng c·ªßa b·∫°n.</p>
      </div>
      <div class="reason">
        <img src="Assets/Icon Images/voucher.png" alt="∆Øu ƒë√£i h·∫•p d·∫´n">
        <h4>∆Øu ƒë√£i h·∫•p d·∫´n</h4>
        <p>Gi√° t·ªët nh·∫•t m·ªói ng√†y d√†nh cho kh√°ch h√†ng th√¢n thi·∫øt.</p>
      </div>
      <div class="reason">
        <img src="Assets/Icon Images/customer-service.png" alt="H·ªó tr·ª£ 24/7">
        <h4>H·ªó tr·ª£ 24/7</h4>
        <p>ƒê·ªôi ng≈© CSKH s·∫µn s√†ng h·ªó tr·ª£ b·∫°n m·ªçi l√∫c, m·ªçi n∆°i.</p>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="footer-container">
      <div class="footer-links">
        <a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
        <span>|</span>
        <a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
        <span>|</span>
        <a href="#">Li√™n h·ªá</a>
      </div>

      <div class="footer-social">
        <p>Theo d√µi ch√∫ng t√¥i</p>
        <div class="social-icons">
          <a href="#"><img src="Assets/Icon Images/facebook.png" alt="Facebook"></a>
          <a href="#"><img src="Assets/Icon Images/instagram.png" alt="Instagram"></a>
          <a href="#"><img src="Assets/Icon Images/communication.png" alt="Telegram"></a>
          <a href="#"><img src="https://cdn-icons-png.flaticon.com/512/3046/3046126.png" alt="TikTok"></a>
        </div>
      </div>
      <br/>
      <p>¬© 2025 <span>Resort Booking</span>. All rights reserved.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/vn.js"></script>
  <script src="voucher.js"></script>
  <script src="destinations.js"></script>

  <!-- Script x·ª≠ l√Ω hi·ªÉn th·ªã ph√≤ng -->
 <script>
    // Fetch d·ªØ li·ªáu ph√≤ng t·ª´ API
    async function fetchRooms() {
      try {
        // ƒê·∫£m b·∫£o URL n√†y l√† ch√≠nh x√°c
        const response = await fetch('http://localhost:5500/api/rooms'); 
        const rooms = await response.json();
        return rooms;
      } catch (error) {
        console.error('L·ªói khi l·∫•y d·ªØ li·ªáu ph√≤ng:', error);
        return [];
      }
    }

    // H√†m render ph√≤ng v√†o m·ªôt container (grid) c·ª• th·ªÉ
    function renderRooms(rooms, containerId) {
      const container = document.getElementById(containerId);
      if (!container) {
        console.error(`Kh√¥ng t√¨m th·∫•y container v·ªõi ID: ${containerId}`);
        return;
      }
      container.innerHTML = ''; // X√≥a n·ªôi dung c≈©

      // Th√™m class 'resort-grid' v√†o #resortList ƒë·ªÉ √°p d·ª•ng CSS t∆∞∆°ng t·ª±
      if (containerId === 'resortList') {
        container.classList.add('resort-grid');
      }

      rooms.forEach(room => {
        const card = document.createElement('div');
        card.className = 'resort-card';
        
        // Format gi√° ti·ªÅn VND
        const formattedPrice = new Intl.NumberFormat('vi-VN', {
          style: 'currency',
          currency: 'VND'
        }).format(room.price_per_night);

        card.innerHTML = `
          <img src="${room.images?.[0] || 'Assets/placeholder.jpg'}" alt="${room.room_type}">
          <div class="resort-info">
            <h3>${room.room_type}</h3>
            <p><i class="fas fa-map-marker-alt"></i> ${room.location || 'H√† N·ªôi'}</p>
            <p class="price">T·ª´ <span>${formattedPrice}/ƒë√™m</span></p>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Load v√† render d·ªØ li·ªáu khi trang ƒë∆∞·ª£c load
    document.addEventListener('DOMContentLoaded', async () => {
      const rooms = await fetchRooms();
      
      // 1. Render v√†o ph·∫ßn ∆ØU ƒê√ÉI N·ªîI B·∫¨T
      renderRooms(rooms, 'dealsGrid'); 

      // 2. Render v√†o ph·∫ßn DANH S√ÅCH RESORT (ngay d∆∞·ªõi thanh t√¨m ki·∫øm)
      renderRooms(rooms, 'resortList');
    });

    // X·ª≠ l√Ω n√∫t ch·ªçn lo·∫°i ph√≤ng
    const typeButtons = document.querySelectorAll('.type-btn');
    typeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        typeButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const selectedType = btn.dataset.type;
        console.log('Lo·∫°i ch·ªó ·ªü ƒë∆∞·ª£c ch·ªçn:', selectedType);
        // Th√™m logic l·ªçc resort theo lo·∫°i ·ªü ƒë√¢y n·∫øu c·∫ßn
      });
    });

    // X·ª≠ l√Ω n√∫t prev/next c·ªßa promo
    const grid = document.getElementById('promoGrid');
    document.getElementById('nextBtn').onclick = () => grid.scrollBy({ left: 360, behavior: 'smooth' });
    document.getElementById('prevBtn').onclick = () => grid.scrollBy({ left: -360, behavior: 'smooth' });

    // X·ª≠ l√Ω destinations
    const destinationGrid = document.getElementById('destinationGrid');
    // Gi·∫£ ƒë·ªãnh m·∫£ng `destinations` ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong destinations.js
    if (typeof destinations !== 'undefined') {
      destinations.forEach(place => {
        const card = document.createElement('div');
        card.className = 'destination-card';
        card.innerHTML = `
          <img src="${place.image}" alt="${place.name}">
          <p>${place.name}</p>
        `;
        destinationGrid.appendChild(card);
      });
    } else {
      console.warn('Kh√¥ng t√¨m th·∫•y m·∫£ng "destinations". ƒê·∫£m b·∫£o destinations.js ƒë√£ ƒë∆∞·ª£c t·∫£i.');
    }
  </script>
</body>
</html>

